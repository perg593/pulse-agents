<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pulse Theme Generator v2</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <header class="header">
        <h1>Pulse Theme Generator v2</h1>
        <p>Extract client site tokens and map them onto the Pulse theme schema.</p>
      </header>

      <section class="status-card">
        <div>
          <span class="status-label">Schema</span>
          <span id="schema-summary">Loading…</span>
        </div>
        <div>
          <span class="status-label">Extractor</span>
          <span id="busy-indicator">Idle</span>
        </div>
      </section>

      <section class="analysis-section">
        <form id="extract-form" class="analysis-form">
          <div class="input-group">
            <label for="url-input">Target URL</label>
            <input
              id="url-input"
              name="url"
              type="url"
              placeholder="https://www.domain.com"
              value="https://www."
              required
            />
          </div>

          <div class="input-group">
            <label for="scheme-input">Color scheme</label>
            <select id="scheme-input" name="scheme">
              <option value="light" selected>Light</option>
              <option value="dark">Dark</option>
            </select>
          </div>

          <div class="input-group">
            <label for="pages-input">Max pages to crawl (1–5)</label>
            <input id="pages-input" name="pages" type="number" min="1" max="5" step="1" value="3" />
          </div>

          <button type="submit" id="submit-button" class="analyze-btn">Run extraction</button>
        </form>
        <p class="hint">
          Outputs land in <code>output/ui-run-*</code>. Re-run mapping later with
          <code>npx tsx scripts/map-to-pulse.ts --raw &lt;raw-findings.json&gt;</code>.
        </p>
      </section>

      <section class="results-card hidden" id="results-panel">
        <h2>Latest run</h2>
        <div id="result-message"></div>
        <div class="result-grid">
          <div>
            <h3>Stats</h3>
            <dl id="stats-list"></dl>
          </div>
          <div>
            <h3>Downloads</h3>
            <ul id="download-list"></ul>
          </div>
        </div>
        <div id="summary-card" class="summary-card hidden">
          <h3>Theme summary</h3>
          <div class="summary-status" id="summary-curated">Curated template compatible</div>
          <div class="summary-grid">
            <div class="summary-colors">
              <div class="summary-color" data-role="primary">
                <span>Primary</span>
                <div class="swatch"></div>
                <code></code>
              </div>
              <div class="summary-color" data-role="secondary">
                <span>Secondary</span>
                <div class="swatch"></div>
                <code></code>
              </div>
              <div class="summary-color" data-role="background">
                <span>Background</span>
                <div class="swatch"></div>
                <code></code>
              </div>
              <div class="summary-color" data-role="text">
                <span>Text</span>
                <div class="swatch"></div>
                <code></code>
              </div>
            </div>
            <div class="summary-typography">
              <span>Font family</span>
              <p id="summary-font">—</p>
            </div>
            <div class="summary-logo hidden" id="summary-logo">
              <span>Logo palette</span>
              <div class="summary-logo-grid" id="summary-logo-grid"></div>
            </div>
          </div>
        </div>
        <div id="palette-card" class="palette-card hidden">
          <div class="palette-header">
            <h3>Customize palette</h3>
            <button type="button" id="reset-palette" class="palette-btn secondary">Reset to defaults</button>
          </div>
          <form id="palette-form" class="palette-form">
            <section class="palette-section">
              <h4 class="palette-section-title">Background Colors</h4>
              <div class="palette-section-content">
                <div class="palette-item">
                  <label class="palette-label">Background 1</label>
                  <div class="palette-input-wrapper">
                    <div class="palette-swatch-display">
                      <div class="palette-swatch" id="background1-swatch"></div>
                      <code class="palette-hex" id="background1-hex">#000000</code>
                    </div>
                    <select id="palette-background1" name="background1" class="palette-select"></select>
                  </div>
                </div>
                <div class="palette-item">
                  <label class="palette-label">Background 2</label>
                  <div class="palette-input-wrapper">
                    <div class="palette-swatch-display">
                      <div class="palette-swatch" id="background2-swatch"></div>
                      <code class="palette-hex" id="background2-hex">#000000</code>
                    </div>
                    <select id="palette-background2" name="background2" class="palette-select"></select>
                  </div>
                </div>
              </div>
            </section>

            <section class="palette-section">
              <h4 class="palette-section-title">Color 1 (Body Text & Primary Accents)</h4>
              <div class="palette-section-content">
                <div class="palette-item">
                  <label class="palette-label">Color 1</label>
                  <div class="palette-input-wrapper">
                    <div class="palette-swatch-display">
                      <div class="palette-swatch" id="color1-swatch"></div>
                      <code class="palette-hex" id="color1-hex">#000000</code>
                    </div>
                    <select id="palette-text" name="text" class="palette-select"></select>
                  </div>
                </div>
                <div class="palette-item">
                  <label class="palette-label">Color 1 alternate</label>
                  <div class="palette-input-wrapper">
                    <div class="palette-swatch-display">
                      <div class="palette-swatch" id="color1-alt-swatch"></div>
                      <code class="palette-hex" id="color1-alt-hex">#000000</code>
                    </div>
                    <select id="palette-primary" name="primary" class="palette-select"></select>
                  </div>
                </div>
              </div>
            </section>

            <section class="palette-section">
              <h4 class="palette-section-title">Color 2 (Surface Background & Secondary Text)</h4>
              <div class="palette-section-content">
                <div class="palette-item">
                  <label class="palette-label">Color 2</label>
                  <div class="palette-input-wrapper">
                    <div class="palette-swatch-display">
                      <div class="palette-swatch" id="color2-swatch"></div>
                      <code class="palette-hex" id="color2-hex">#000000</code>
                    </div>
                    <select id="palette-background" name="background" class="palette-select"></select>
                  </div>
                </div>
                <div class="palette-item">
                  <label class="palette-label">Color 2 alternate</label>
                  <div class="palette-input-wrapper">
                    <div class="palette-swatch-display">
                      <div class="palette-swatch" id="color2-alt-swatch"></div>
                      <code class="palette-hex" id="color2-alt-hex">#000000</code>
                    </div>
                    <select id="palette-secondary" name="secondary" class="palette-select"></select>
                  </div>
                </div>
              </div>
            </section>

            <button type="submit" id="apply-palette" class="palette-btn primary generate-theme-btn">Generate Theme</button>
          </form>
          <p id="palette-status" class="palette-status hidden"></p>
        </div>
        <div id="css-card" class="copy-card hidden">
          <div class="copy-card__header">
            <h3>Pulse CSS snippet</h3>
            <button type="button" id="copy-css-button" class="copy-btn">Copy CSS</button>
          </div>
          <p class="copy-note">Paste this into Pulse Insights &rarr; Theme CSS.</p>
          <pre><code id="css-snippet"></code></pre>
        </div>
        <div id="colors-section" class="hidden">
          <h3>Distinct colors detected</h3>
          <div id="color-swatches" class="colors-container"></div>
        </div>
        <div id="errors-container" class="hidden">
          <h3>Extraction warnings</h3>
          <ul id="errors-list"></ul>
        </div>
        <details id="preview-details" class="hidden">
          <summary>Preview theme.json</summary>
          <pre id="theme-preview"></pre>
        </details>
      </section>
    </div>

    <template id="stat-item-template">
      <div class="stat-item">
        <dt></dt>
        <dd></dd>
      </div>
    </template>

    <script type="module" src="ui.js"></script>
  </body>
</html>
