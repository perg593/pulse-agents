<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pulse Theme Generator v2</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <header class="header">
        <h1>Pulse Theme Generator v2</h1>
        <p>Extract client site tokens and map them onto the Pulse theme schema.</p>
      </header>

      <section class="status-card">
        <div>
          <span class="status-label">Schema</span>
          <span id="schema-summary">Loading…</span>
        </div>
        <div>
          <span class="status-label">Extractor</span>
          <span id="busy-indicator">Idle</span>
        </div>
      </section>

      <section class="analysis-section">
        <form id="extract-form" class="analysis-form">
          <div class="input-group">
            <label for="url-input">Target URL</label>
            <input
              id="url-input"
              name="url"
              type="url"
              placeholder="https://www.domain.com"
              value="https://www."
              required
            />
          </div>

          <div class="input-group">
            <label for="scheme-input">Color scheme</label>
            <select id="scheme-input" name="scheme">
              <option value="light" selected>Light</option>
              <option value="dark">Dark</option>
            </select>
          </div>

          <div class="input-group">
            <label for="pages-input">Max pages to crawl (1–5)</label>
            <input id="pages-input" name="pages" type="number" min="1" max="5" step="1" value="3" />
          </div>

          <button type="submit" id="submit-button" class="analyze-btn">Run extraction</button>
        </form>
        <p class="hint">
          Outputs land in <code>output/ui-run-*</code>. Re-run mapping later with
          <code>npx tsx scripts/map-to-pulse.ts --raw &lt;raw-findings.json&gt;</code>.
        </p>
      </section>

      <section class="results-card hidden" id="results-panel">
        <h2>Latest run</h2>
        <div id="result-message"></div>
        <div class="result-grid">
          <div>
            <h3>Stats</h3>
            <dl id="stats-list"></dl>
          </div>
          <div>
            <h3>Downloads</h3>
            <ul id="download-list"></ul>
          </div>
        </div>
        <div id="summary-card" class="summary-card hidden">
          <h3>Theme summary</h3>
          <div class="summary-status" id="summary-curated">Curated template compatible</div>
          <div class="summary-grid">
            <div class="summary-colors">
              <div class="summary-color" data-role="primary">
                <span>Primary</span>
                <div class="swatch"></div>
                <code></code>
              </div>
              <div class="summary-color" data-role="secondary">
                <span>Secondary</span>
                <div class="swatch"></div>
                <code></code>
              </div>
              <div class="summary-color" data-role="background">
                <span>Background</span>
                <div class="swatch"></div>
                <code></code>
              </div>
              <div class="summary-color" data-role="text">
                <span>Text</span>
                <div class="swatch"></div>
                <code></code>
              </div>
            </div>
            <div class="summary-typography">
              <span>Font family</span>
              <p id="summary-font">—</p>
            </div>
            <div class="summary-logo hidden" id="summary-logo">
              <span>Logo palette</span>
              <div class="summary-logo-grid" id="summary-logo-grid"></div>
            </div>
          </div>
        </div>
        <div id="palette-card" class="palette-card hidden">
          <div class="palette-header">
            <h3>Customize palette</h3>
            <div class="palette-actions-row">
              <button type="button" id="reset-palette" class="palette-btn secondary">Reset to defaults</button>
            </div>
          </div>
          <div class="palette-layout">
            <section class="palette-defaults">
              <h4>Pulse color pairs</h4>
              <div id="palette-default-list" class="palette-default-list"></div>
            </section>
            <div class="palette-workspace">
              <form id="palette-form" class="palette-form">
                <section class="palette-group" data-palette-group="bodyPrimary">
                  <header>
                    <h4>Body + Primary pair</h4>
                    <p>Maps to `$color-1` & `$color-1-alt`</p>
                  </header>
                  <label class="palette-field">
                    <span>Body text</span>
                    <select id="palette-text" name="text"></select>
                  </label>
                  <label class="palette-field">
                    <span>Primary accents</span>
                    <select id="palette-primary" name="primary"></select>
                  </label>
                </section>
                <section class="palette-group" data-palette-group="surfaceSecondary">
                  <header>
                    <h4>Surface + Secondary pair</h4>
                    <p>Maps to `$color-2` & `$color-2-font`</p>
                  </header>
                  <label class="palette-field">
                    <span>Surface background</span>
                    <select id="palette-background" name="background"></select>
                  </label>
                  <label class="palette-field">
                    <span>Secondary text</span>
                    <select id="palette-secondary" name="secondary"></select>
                  </label>
                </section>
                <button type="submit" id="apply-palette" class="palette-btn primary">Apply selection</button>
              </form>
              <section class="palette-preview">
                <h4>Preview</h4>
                <div class="palette-preview-grid">
                  <div class="preview-item" data-preview="primary">
                    <span>Primary</span>
                    <div class="swatch"></div>
                    <code></code>
                  </div>
                  <div class="preview-item" data-preview="secondary">
                    <span>Secondary</span>
                    <div class="swatch"></div>
                    <code></code>
                  </div>
                  <div class="preview-item" data-preview="background">
                    <span>Background</span>
                    <div class="swatch"></div>
                    <code></code>
                  </div>
                  <div class="preview-item" data-preview="text">
                    <span>Text</span>
                    <div class="swatch"></div>
                    <code></code>
                  </div>
                </div>
              </section>
              <p id="palette-status" class="palette-status hidden"></p>
            </div>
          </div>
        </div>
        <div id="css-card" class="copy-card hidden">
          <div class="copy-card__header">
            <h3>Pulse CSS snippet</h3>
            <button type="button" id="copy-css-button" class="copy-btn">Copy CSS</button>
          </div>
          <p class="copy-note">Paste this into Pulse Insights &rarr; Theme CSS.</p>
          <pre><code id="css-snippet"></code></pre>
        </div>
        <div id="colors-section" class="hidden">
          <h3>Distinct colors detected</h3>
          <div id="color-swatches" class="color-grid"></div>
        </div>
        <div id="errors-container" class="hidden">
          <h3>Extraction warnings</h3>
          <ul id="errors-list"></ul>
        </div>
        <details id="preview-details" class="hidden">
          <summary>Preview theme.json</summary>
          <pre id="theme-preview"></pre>
        </details>
      </section>
    </div>

    <template id="stat-item-template">
      <div class="stat-item">
        <dt></dt>
        <dd></dd>
      </div>
    </template>

    <script type="module" src="ui.js"></script>
  </body>
</html>
