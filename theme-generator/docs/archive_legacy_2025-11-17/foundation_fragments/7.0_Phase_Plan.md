## 7. Implementation Phasing (for Cursor)

This section is intentionally conceptual; Cursor will handle the details.

### Phase 0 – Theme Playground (Local only)

* Simple app with:

  * A small theme object (colors + fonts + radii).
  * A fake Pulse survey preview.
  * Desktop/mobile toggle.
* No backend, no analysis, no persistence.

### Phase 1 – Theme Tokens + SCSS Template Integration

* Evolve the theme object into a **richer Theme Tokens structure** (based on this doc).
* Create or refactor `theme-template.scss` to:

  * Use variables/ maps driven by Theme Tokens.
* Wire up:

  * Theme Tokens → SCSS → CSS → preview.

### Phase 2 – Theme Projects & Persistence

* Introduce **Theme Projects**:

  * Multiple projects stored in the UI.
  * Each project holds multiple themes.
* Provide:

  * Create project
  * Rename project
  * Add/duplicate themes per project
* Persist projects somewhere simple (local dev first).

### Phase 3 – Analyzer & Auto Generation (URL → 4 Themes)

* Implement analyzer:

  * Given URL + page count → Site Snapshot.
* Implement generation:

  * Site Snapshot → 4 Theme Tokens (Brand Faithful, Light, Dark, Minimal).
* Integrate analysis trigger into the UI:

  * Enter URL + pages → click “Analyze” → get 4 themes in current project.

### Phase 4 – Style Guide & Refinements

* Add Style Guide view for each theme:

  * Colors
  * Typography samples
  * Component examples
  * Contrast indicators
* Let users:

  * Export style guide as HTML or Markdown (optional).
* Improve:

  * Font handling
  * Spacing/kerning controls
  * Tablet preview

---






## 8. Placeholder. Ignore this

---







## 9. Phase 1 – Theme Tokens Lite & SCSS Pipeline (Practical Plan)

### 9.1 Goals for Phase 1

Phase 1 should **evolve** the current playground into something closer to the final architecture, but without going “full enterprise schema” yet.

Concretely:

1. Upgrade the `SimpleTheme` into a **Theme Tokens Lite** structure:

   * Still understandable at a glance.
   * Already aligned with the bigger Theme Tokens concepts (palette, typography, components).
2. Replace inline / hardcoded styles in `SurveyPreview` with:

   * A **SCSS template** that takes variables from the theme.
   * A **basic SCSS → CSS compilation step**.
3. Continue to:

   * Keep everything local (no backend, no analyzer).
   * Keep the UI simple and working.
   * Let me still edit theme values and see live preview for Desktop/Mobile.

This is the bridge between the toy playground and the real engine.

---

### 9.2 Theme Tokens Lite (v0.1)

Instead of jumping straight to the full Theme Tokens spec, Phase 1 will introduce a **small, structured theme model** that still feels similar to the final shape.

#### 9.2.1 ThemeTokensLite shape (conceptual)

Implementation detail is up to Cursor, but the model should look roughly like this:

```ts
// Conceptual shape, not a final TS interface name requirement

ThemeTokensLite {
  id: string;
  name: string;                 // "Brand Faithful", "Visa Light v1", etc.
  variantType: "custom" | "brand-faithful" | "light" | "dark" | "minimal";

  // Palette – simple but more semantic than Phase 0
  palette: {
    background: string;         // widget background
    surface: string;            // cards / options background
    surfaceAlt: string;         // hover or subtle surface
    textPrimary: string;
    textSecondary: string;
    brandPrimary: string;
    brandSecondary: string;
    accent: string;
    danger: string;
    success: string;
  };

  // Typography – stripped-down but ready for growth
  typography: {
    fontFamilyBase: string;
    fontFamilyHeading?: string;
    baseFontSize: number;       // px
    headingSize: number;        // px, for question titles
    bodySize: number;           // px, for body / option text
    buttonSize: number;         // px
  };

  // Components – just enough to express key Pulse components
  components: {
    widget: {
      headerBg: string;
      headerText: string;
      bodyBg: string;
      bodyText: string;
      borderColor: string;
    };

    singleChoice: {
      bgDefault: string;
      bgActive: string;
      textDefault: string;
      textActive: string;
      borderDefault: string;
      borderActive: string;
    };

    ctaButton: {
      bg: string;
      text: string;
      bgHover: string;
      textHover: string;
    };
  };

  // Layout / shape
  layout: {
    borderRadius: number;       // base radius for options + buttons
    spacingMd: number;          // main padding / gap, px
  };
}
```

Notes:

* This **replaces** the current `SimpleTheme` (`primaryColor`, `secondaryColor`, etc.).
* It is intentionally small:

  * Enough to feel like “real theme tokens”.
  * Not so big that editing it is overwhelming.
* It lines up nicely with the bigger Theme Tokens idea (palette, typography, components, spacing).

---

### 9.3 SCSS Template for Preview

Phase 1 introduces a **SCSS template** to drive the preview instead of inline styles.

Key ideas:

1. Create a new SCSS file (for example):
   `src/styles/theme-template-v1.scss`

2. This file should:

   * Define **CSS rules** for the fake survey markup used in `SurveyPreview`:

     * `.pi-widget`
     * `.pi-widget-header`
     * `.pi-widget-body`
     * `.pi-question-title`
     * `.pi-option`
     * `.pi-option--active`
     * `.pi-text-input`
     * `.pi-submit-button`
   * Rely on **SCSS variables** (or a map) for:

     * Colors
     * Font families
     * Font sizes
     * Border radius
     * Spacing

   Example variables (illustrative, Cursor can refine):

   ```scss
   $pi-bg: #ffffff;
   $pi-surface: #f9fafb;
   $pi-text-primary: #111827;
   $pi-text-secondary: #4b5563;
   $pi-brand-primary: #2563eb;
   $pi-brand-secondary: #9333ea;
   $pi-accent: #f97316;
   $pi-danger: #dc2626;
   $pi-success: #16a34a;

   $pi-font-base: "system-ui", sans-serif;
   $pi-font-heading: "system-ui", sans-serif;
   $pi-font-size-base: 14px;
   $pi-font-size-heading: 18px;
   $pi-font-size-button: 14px;

   $pi-border-radius: 9999px; // or 8px etc
   $pi-spacing-md: 12px;
   ```

3. Phase 1 does **not** need to integrate with the full Pulse SCSS framework yet.

   * This template is **scoped to the preview only**.
   * Later phases can replace it with a template that wraps the real Pulse SCSS.

---

### 9.4 SCSS → CSS Compilation Pipeline (Preview Only)

For Phase 1, the compilation can be **local, simple, and dev-only**:

* Use `sass` (Dart Sass) in Node.

* Implement a small function/module (e.g. `src/theme/compileTheme.ts`) that:

  1. Takes a `ThemeTokensLite` instance.
  2. Generates a SCSS string:

     * Sets the SCSS variables derived from the theme.
     * Imports `theme-template-v1.scss`.
  3. Calls `sass.compileString` (or similar) to get CSS.
  4. Returns CSS as a string.

* `SurveyPreview` should:

  * Call this compilation function whenever the theme changes.
  * Inject the compiled CSS into the iframe’s `srcDoc` (instead of inline styles).

**Performance note:**
It’s okay if this is not insanely optimized in v1. The goal is correctness and a clear pathway, not micro-performance.

---

### 9.5 UI/UX Changes in Phase 1

1. **Theme Editor**

   * Update `ThemeEditor` to edit `ThemeTokensLite` instead of `SimpleTheme`.
   * Group fields in logical sections:

     * Palette
     * Typography
     * Components (Widget, Single Choice, CTA)
     * Layout (radius, spacing)
   * Keep the UI minimal:

     * Don’t expose every nested field if overwhelming.
     * It’s okay to start with:

       * Basic palette fields
       * Font family + basic sizes
       * A few component fields
       * Border radius

2. **Survey Preview**

   * Stop generating inline CSS in JS.
   * Use the compiled CSS from the SCSS pipeline.
   * Keep:

     * Desktop/Mobile toggle.
     * Same markup for the fake Pulse survey.

3. **State Management**

   * Keep using Zustand.
   * State should hold a `ThemeTokensLite` object instead of `SimpleTheme`.

---

### 9.6 What Cursor Should Implement in Phase 1

This is the concrete work Cursor should do:

1. **Introduce ThemeTokensLite**

   * Replace `SimpleTheme` in `src/types/theme.ts` with a `ThemeTokensLite` structure (similar to 9.2.1).
   * Update `themeStore.ts` to use this new type.
   * Update `ThemeEditor` to edit the new shape.

2. **Add SCSS Template**

   * Create `src/styles/theme-template-v1.scss`.
   * Move existing hardcoded styles for the fake survey into this file, but expressed with SCSS variables as in 9.3.

3. **Add SCSS Compilation Function**

   * Add a module (e.g. `src/theme/compileTheme.ts`) that:

     * Accepts `ThemeTokensLite`.
     * Generates a SCSS string that:

       * Sets SCSS variables based on the theme.
       * Imports `theme-template-v1.scss`.
     * Compiles it to CSS using `sass` (Dart Sass).
   * For Phase 1, this can run on the client or via a dev-time helper—Cursor can pick the simplest approach compatible with Vite.

4. **Wire Compilation to Preview**

   * Update `SurveyPreview` so it:

     * Uses the new compile function.
     * Injects the compiled CSS into the `iframe srcDoc`.
   * Remove any previous inline style generation logic.

5. **Keep DX Smooth**

   * Ensure I can still:

     * Run `npm install`
     * Run `npm run dev`
     * Edit theme values and see live changes in the preview.

---

### 9.7 Out of Scope for Phase 1

Phase 1 explicitly does **not** include:

* Full, comprehensive Theme Tokens schema from the long-term design.
* Integration with existing Pulse `sass-framework/01-css-pulse/` files.
* Express backend / API server.
* Playwright/Puppeteer analyzer.
* Theme Projects & persistence.
* URL analysis or automatic 4-theme generation.
* Style guide export.

Those belong in **Phase 2 and beyond**, once this SCSS + ThemeTokensLite path is solid.