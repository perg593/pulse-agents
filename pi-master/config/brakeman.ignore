{
  "ignored_warnings": [
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "4f45647b6dd6ded40ec8fb1671f74e79c80161fe78d9d0869ab630f1c36b2632",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/presenters/control/survey_index_presenter.rb",
      "line": 215,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "SurveySubmissionCache.joins(:survey).where(:survey => surveys).where(:applies_to_date => date_range).select(\"survey_id,\\nMAX(last_impression_at) AS last_impression_at,\\nMAX(last_submission_at) AS last_submission_at,\\nCOALESCE(SUM(submission_count), 0) AS num_submissions,\\nCOALESCE(SUM(CASE\\n  WHEN applies_to_date < '#{current_user.account.viewed_impressions_calculation_start_at}'\\n    THEN impression_count\\n  ELSE viewed_impression_count\\nEND), 0) AS num_impressions\\n\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Control::SurveyIndexPresenter",
        "method": "cache_data"
      },
      "user_input": "current_user.account.viewed_impressions_calculation_start_at",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "505604640c4826c75cca45049e079de953967fe9f37b16308cb996322d67dfdf",
      "check_name": "FileAccess",
      "message": "Parameter value used in file name",
      "file": "app/controllers/admin/pdf_template_file_uploads_controller.rb",
      "line": 85,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "FileUtils.cp(params[:files].find do\n file.original_filename.end_with?(\".erb\")\n end.tempfile.path, Rails.root.join(\"tmp\", File.basename(params[:files].find do\n file.original_filename.end_with?(\".erb\")\n end.tempfile)))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Admin::PDFTemplateFileUploadsController",
        "method": "validate_erb"
      },
      "user_input": "params[:files].find",
      "confidence": "Weak",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "644da8dcd2bf84dc3127af6db5cfcde03786d6189849f39c2108ff6bc6c020a6",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/controllers/admin/pdf_template_file_uploads_controller.rb",
      "line": 102,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "Process.spawn(\"sudo -u pdf_validator ruby app/lib/pdf_template_validator.rb #{template_file_path}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Admin::PDFTemplateFileUploadsController",
        "method": "validate_pdf"
      },
      "user_input": "template_file_path",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": "template_file_path comes from a Tempfile and won't have any user provided information."
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "e09fd2527387f84341aa56355c785f092923b9c941571c37903dcfd84c2cd013",
      "check_name": "FileAccess",
      "message": "Parameter value used in file name",
      "file": "app/controllers/admin/pdf_template_file_uploads_controller.rb",
      "line": 89,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "File.delete(Rails.root.join(\"tmp\", File.basename(params[:files].find do\n file.original_filename.end_with?(\".erb\")\n end.tempfile)))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Admin::PDFTemplateFileUploadsController",
        "method": "validate_erb"
      },
      "user_input": "params[:files].find",
      "confidence": "Weak",
      "cwe_id": [
        22
      ],
      "note": ""
    }
  ],
  "updated": "2025-03-13 10:17:14 -0700",
  "brakeman_version": "6.1.2"
}
