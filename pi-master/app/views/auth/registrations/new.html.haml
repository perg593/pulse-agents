- has_valid_account = @user.account&.valid?

- title 'Sign Up'

= simple_form_for @user, url: sign_up_path, defaults: { label: false }, html: { role: 'form' } do |form|
  .form-title= has_valid_account ? "Join Account '#{@user.account.name}'" : 'Create New Account'
  = form.input :invite_token, as: :hidden
  = form.input :email, input_html: { placeholder: 'Email Address', autofocus: true, readonly: @invitation.present? }
  .name.clearfix
    = form.input :first_name, input_html: { placeholder: 'First Name' }, wrapper_html: { class: 'pull-left' }
    = form.input :last_name, input_html: { placeholder: 'Last Name' }, wrapper_html: { class: 'pull-right' }
  = form.input :password, input_html: { placeholder: 'Password', autocomplete: "off" }

  - unless has_valid_account
    = form.simple_fields_for :account, Account.new do |account_fields|
      = account_fields.input :name, label: 'Company Name', required: true

  .form-action
    = form.submit has_valid_account ? 'Join Account' : 'Create Account'
